<script>
  async function deleteProduct(productId) {
    const { value: result } = await Swal.fire({
      title: '¿Estás seguro?',
      text: "¡No podrás recuperar este producto!",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#3085d6',
      cancelButtonColor: '#d33',
      confirmButtonText: 'Sí, eliminarlo!',
      cancelButtonText: 'Cancelar'
    });

    if (result) {
      const response = await fetch(`/admin/products/${productId}`, {
        method: 'DELETE',
      });

      if (response.ok) {
        Swal.fire(
          'Eliminado!',
          'El producto ha sido eliminado.',
          'success'
        );
        // Recargar la página o actualizar la tabla de productos
        location.reload();
      } else {
        const error = await response.json();
        Swal.fire('Error', error.message, 'error');
      }
    }
  }
</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<input type="text" id="search" placeholder="Buscar producto..">
<table>
  {{#each products}}
    <tr>
      <td>{{this._id}}</td>
      <td>{{this.title}}</td>
      <td>{{this.description}}</td>
      <td>{{this.code}}</td>
      <td>{{this.price}}</td>
      <td>{{this.stock}}</td>
      <td>{{this.category}}</td>
      <td>{{this.owner}}</td>
      <td><a href="/admin/users/edit/{{this._id}}">Editar</a></td>
      <td>
      <button onclick="deleteProduct('{{this._id}}')">Eliminar</button>
      </td>
    </tr>
  {{/each}}
</table>